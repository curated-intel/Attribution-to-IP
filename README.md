# Attribution to IP
- A collection of methods to learn who the owner of an IP address is.
- The reason for this could be for the IP being victimised in an attack, being currently compromised, or having security misconfigurations and could be attacked.
- These methods are useful for cyber threat intelligence (CTI) analysts performing victim notifications or security researchers working on bug bounty programs. 

## OSINT & Freemium Services
> [!NOTE]
> These are free methods, but paid accounts may be available for some of these services for more information, authenticated APIs, and higher rate limits.

| Method | Description | Source(s) |
| --- | --- | --- |
| Passive DNS (pDNS) | Shows historical DNS resolutions for an IP and allows you to identify domains that have pointed to the IP. | [ViewDNS.info](https://viewdns.info) / [VirusTotal](https://www.virustotal.com)  / [OTX AlienVault](https://otx.alienvault.com/) / [Mnemonic](https://passivedns.mnemonic.no/) / [DNSlytics](https://search.dnslytics.com/) / [subdomainfinder](https://subdomainfinder.c99.nl/) / [Validin](https://www.validin.com/) / [SilentPush](https://www.silentpush.com/) / [Driftnet](https://driftnet.io/search/summary) / [SecurityTrails](https://securitytrails.com/) / [Rapid7 Project Sonar](https://opendata.rapid7.com/) |
| Domain DNS Records | Includes A, PTR, MX, TXT, and CNAME records. PTR records can reveal the hostname; TXT and MX can give clues about the domainâ€™s owner or provider. | [ViewDNS.info](https://viewdns.info) / [CentralOps](https://centralops.net/co/) / [DNSlytics](https://search.dnslytics.com/) / [DNSDumpster](https://dnsdumpster.com/) / [VirusTotal](https://www.virustotal.com) / [Validin](https://www.validin.com/) / [SilentPush](https://www.silentpush.com/) / [Driftnet](https://driftnet.io/search/summary) / [SecurityTrails](https://securitytrails.com/) / [Rapid7 Project Sonar](https://opendata.rapid7.com/) |
| IP WHOIS | Queries registrar and network block registration info. Can directly identify the entity or ISP that registered the IP range. | [ViewDNS.info](https://viewdns.info) / [DomainTools](https://whois.domaintools.com/) / [CentralOps](https://centralops.net/co/) / [Who.is](https://who.is/) / [IPVOID](https://www.ipvoid.com/) / [VirusTotal](https://www.virustotal.com) / [Validin](https://www.validin.com/) / [SilentPush](https://www.silentpush.com/) / [ZoomEye](https://www.zoomeye.ai/) / [SANS ISC](https://isc.sans.edu/ipinfo/) |
| Open Ports & Running Services | Scanning the IP for accessible ports and services. Banner grabbing can reveal software, versions, and sometimes organization names. | [Shodan](https://www.shodan.io/) / [FOFA](https://en.fofa.info/) / [Censys](https://search.censys.io/) / [Onyphe](https://search.onyphe.io/) / [Modat](https://modat.io) / [Odin](https://odin.io/) / [IPVOID](https://www.ipvoid.com/) / [Driftnet](https://driftnet.io/search/summary) / [ZoomEye](https://www.zoomeye.ai/) / [Rapid7 Project Sonar](https://opendata.rapid7.com/) |
| X509 Certificates | Examine SSL certs served on open HTTPS ports. Certs often contain domains, email addresses, or organization names. | [Certificate Search](https://crt.sh) / [Certstream](https://certstream.calidog.io/) / [Shodan](https://www.shodan.io/)  / [Censys](https://search.censys.io/) / [Modat](https://modat.io) / [Odin](https://odin.io/) / [Validin](https://www.validin.com/) / [SilentPush](https://www.silentpush.com/) / [Driftnet](https://driftnet.io/search/summary) / [Rapid7 Project Sonar](https://opendata.rapid7.com/) |
| Autonomous System Names (ASNs) | ASNs describe ownership of blocks of IP addresses. Helps identify the ISP, hosting provider, or large organization behind a network. | [Team Cymru](https://v4.whois.cymru.com/cgi-bin/whois.cgi) / [IPinfo](https://ipinfo.io/) / [InfoByIP](https://www.infobyip.com/) / [IPQS](https://www.ipqualityscore.com/) / [Shodan](https://www.shodan.io/) / [FOFA](https://en.fofa.info/) / [Censys](https://search.censys.io/) / [Onyphe](https://search.onyphe.io/) / [Modat](https://modat.io) / [Odin](https://odin.io/) / [IPVOID](https://www.ipvoid.com/) / [Cloudflare Radar](https://radar.cloudflare.com/ip) / [VirusTotal](https://www.virustotal.com) / [Driftnet](https://driftnet.io/search/summary)  / [ZoomEye](https://www.zoomeye.ai/) / [SilentPush](https://www.silentpush.com/) |
| IP Geolocation | Maps IP to approximate physical location. Helps determine country or city, which may assist in narrowing the scope of who the owner is. | [MaxMind](https://www.maxmind.com/en/geoip-demo) / [IPinfo](https://ipinfo.io/) / [InfoByIP](https://www.infobyip.com/) / [IPQS](https://www.ipqualityscore.com/) / [Shodan](https://www.shodan.io/) / [FOFA](https://en.fofa.info/) / [Censys](https://search.censys.io/) / [Onyphe](https://search.onyphe.io/) / [Odin](https://odin.io/) / [IPVOID](https://www.ipvoid.com/) / [Cloudflare Radar](https://radar.cloudflare.com/ip) / [SilentPush](https://www.silentpush.com/) |
| Border Gateway Protocol (BGP) | BGP announcements tell you who is routing the IP block and confirms the autonomous system or network managing the address. | [BGP Hurricane Electric](https://bgp.he.net/) / [BGP Tools](https://bgp.tools/) / [Qrator Radar](https://radar.qrator.net/) / [BGPView](https://bgpview.io/) |
| Content Archives | Archived content of websites on the IP or screenshots of the services on the IP and may show earlier branding, contact info, or domains before a site changed. | [cachedview](https://cachedview.com/) [URLscan](https://urlscan.io/) / [Wayback Machine](https://web.archive.org/) / [Shodan](https://www.shodan.io/) / [SilentPush](https://www.silentpush.com/) / [WebPageTest](https://www.webpagetest.org/) |
| Manual Browsing | Visiting the IP directly in a browser can sometimes reveals landing pages, admin panels, or redirect behavior with company names or logos. | [Browserling](https://www.browserling.com/)  / [ANY.RUN](https://app.any.run/) |
| Google Dorking | Use advanced search engine operators to find references to the IP online search engine results that could be used to identify its owner. | [Google Dork Examples](https://github.com/BushidoUK/OSINT-SearchOperators/blob/main/GoogleDorks.csv) / [VirusTotal](https://www.virustotal.com) |
| Code Repositories | Search in code repositories for references to the IP as the developers sometimes hardcode IPs in their code and configuration files. | [GitHub](https://github.com/) / [BitBucket](https://bitbucket.org/) |
| Linked to Tor Nodes, VPNs, or Proxies | Checking in lists of Tor, VPNs, or Proxy nodes suggests the IP is not owned by a specific end-user but part of a privacy or anonymisation network. | [TOR Node List](https://dev.dan.me.uk/tornodes) / [IPQS](https://www.ipqualityscore.com/) / [Spur](https://spur.us/context/me) / [IP2PROXY](https://www.ip2proxy.com/) / [Proxycheck.io](https://proxycheck.io/lookup/) / [SilentPush](https://www.silentpush.com/) |
| Cloud Storage | Cloud storage buckets may contain config files, logs, build artifacts, or naming conventions that tie back to the IP owner. | [GrayHatWarfare](https://grayhatwarfare.com/) / [Odin](https://odin.io/) |
| IP Behaviours | Honeypot networks and crowdsourced reporting sites can also help discern what an IP is doing and who owns it based on it's observed interactions with honeypot and victim IPs. | [GreyNoise](https://viz.greynoise.io/) / [AbuseIPDB](https://www.abuseipdb.com/) / [CrowdSec](https://app.crowdsec.net/cti) / [Project Honeypot](https://www.projecthoneypot.org/list_of_ips.php) / [SANS ISC](https://isc.sans.edu/ipinfo/) |
| Security TXT Records| Querying the IP directly can reveal the security TXT file at .well_known/security.txt or /security.txt paths on a host ip. DNS implementations also exist for security TXT files, these can be found as DNS TXT records.  | [Browserling](https://www.browserling.com/) / [Mxtoolbox](https://mxtoolbox.com/DNSLookup.aspx) / [urlscan](https://urlscan.io) / [security txt](https://securitytxt.org/) / [dns security txt](https://dnssecuritytxt.org/) |
| Cryptocurrency Network Nodes | Lists of IPs used for publicly distributed networks supporting cryptocurrency mining and ledger recording activities. | [Bitnodes.io](https://bitnodes.io/nodes/) / [Ethernodes.org](https://ethernodes.org/) |
| Service Provider IP Ranges | Lists of IP addresses reported as belonging to Cloud, CDN, and other service providers. | [Cloudflare](https://www.cloudflare.com/en-gb/ips/) / [Oracle](https://docs.oracle.com/en-us/iaas/tools/public_ip_ranges.json) / [GitHub](https://api.github.com/meta) / [Microsoft Azure](https://www.microsoft.com/en-us/download/details.aspx?id=56519) / [Microsoft 365](https://endpoints.office.com/changes/worldwide/0000000000?clientrequestid=b10c5ed1-bad1-445f-b386-b919946339a7) / [Google Cloud](https://www.gstatic.com/ipranges/cloud.json) / [Amazon Web Services](https://ip-ranges.amazonaws.com/ip-ranges.json) / [Fastly](https://api.fastly.com/public-ip-list) / [Imperva](https://docs.imperva.com/bundle/z-kb-articles-knowledgebase-support/page/290228110.html) / [Akamai](https://techdocs.akamai.com/origin-ip-acl/docs/update-your-origin-server) |

## Commercial
> [!WARNING]
> These are paid services only typically available for enterprises or public sector organisations and provide more information and authenticated APIs.

| Method | Description | Source(s) |
| --- | --- | --- |
| NetFlow | NetFlow captures metadata about traffic flows (source/destination IPs, ports, protocol, timestamps) and can be used to track communication patterns, peer IPs, and usage behavior. Repeated traffic between an IP and a corporate network could indicate ownership. | [Team Cymru Pure Signal](https://www.team-cymru.com/) |
| Breach Data | Breach Data includes leaked credentials, config files, and service records from compromised systems and could be used to directly connect an IP to an email address, domain, or username and imply corporate ownership. | [SpyCloud](https://spycloud.com/) / [AmIBreached](https://amibreached.com/) / [Intelx](https://intelx.io/) / [Dehashed](https://dehashed.com/) / [Socradar](https://socradar.io/) / [Hudsonrock](http://hudsonrock.com/) |
| Internet Scraping Databases | Internet scraping databases collect, store, and index citations from the darkweb, cybercrime forum posts, messaging services, paste sites, legit news sites, and technical blogs, among other sources. They may have data on IP addresses such as where they were first and last mentioned and in what context. | [Recorded Future](https://www.recordedfuture.com/) / [Anomali ThreatStream](https://www.anomali.com/products/threatstream) / [Intel471](https://intel471.com/solutions/dark-web-monitoring-and-investigations) / [Flashpoint](https://flashpoint.io/ignite/cyber-threat-intelligence/) / [Cyble](https://cyble.com/) |

## Additional Resources
- [Pivot Atlas](https://gopivot.ing/tools/) - A list of various tools and platforms that enable different types of pivots on different types of data.
- [IOC Vetting Sources](https://github.com/BushidoUK/Open-source-tools-for-CTI/blob/master/IOC-vetting.md) - A list of various tools and platforms to check the reputation of an IP address.
- [ThreatFox](https://threatfox.abuse.ch/browse/) - ThreatFox is a platform from abuse.ch and Spamhaus dedicated to sharing indicators of compromise (IOCs) associated with malware, with the infosec community, AV vendors and cyber threat intelligence providers. Upload IOCs and explore the database for valuable intelligence. Use the APIs to seamlessly push and pull signals, and automate bulk queries.

### Special Credits
- Thanks to Dan, Conor, and Josh from Team Cymru
- Thanks to Amitai and Ralph from Curated Intel
